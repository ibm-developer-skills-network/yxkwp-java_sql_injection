<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Injection Vulnerability Demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .container { max-width: 1000px; }
        pre { background-color: #f8f9fa; padding: 10px; border-radius: 5px; }
        .card { margin-bottom: 20px; }
        .attack-example { background-color: #fff3cd; padding: 5px; border-radius: 3px; font-family: monospace; }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">SQL Injection Vulnerability Demo</h1>
        
        <div class="alert alert-warning">
            <strong>Warning:</strong> This application contains deliberate security vulnerabilities for educational purposes only.
        </div>
        
        <div class="card">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0">Vulnerable User Endpoint</h5>
            </div>
            <div class="card-body">
                <h6>User Search (Vulnerable to SQL Injection)</h6>
                <p>Try the attack: <span class="attack-example">admin' OR '1'='1</span></p>
                <div class="input-group mb-3">
                    <input type="text" id="user-input" class="form-control" placeholder="Enter username">
                    <button class="btn btn-outline-danger" type="button" id="user-btn">Search</button>
                </div>
                <h6>SQL Query:</h6>
                <pre id="user-query">SELECT * FROM users WHERE username = 'input'</pre>
                <h6>Result:</h6>
                <pre id="user-result" style="max-height: 200px; overflow-y: auto;">Results will appear here</pre>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0">Vulnerable Role Endpoint</h5>
            </div>
            <div class="card-body">
                <h6>User Search by Role (Vulnerable to SQL Injection)</h6>
                <p>Try the attack: <span class="attack-example">USER' OR '1'='1</span></p>
                <div class="input-group mb-3">
                    <input type="text" id="role-input" class="form-control" placeholder="Enter role">
                    <button class="btn btn-outline-danger" type="button" id="role-btn">Search</button>
                </div>
                <h6>SQL Query:</h6>
                <pre id="role-query">SELECT * FROM users WHERE role = 'input'</pre>
                <h6>Result:</h6>
                <pre id="role-result" style="max-height: 200px; overflow-y: auto;">Results will appear here</pre>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0">Vulnerable Product Search</h5>
            </div>
            <div class="card-body">
                <h6>Search Products by Category and Price (Vulnerable to SQL Injection)</h6>
                <p>Try the attack in price field: <span class="attack-example">100' OR '1'='1</span></p>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <input type="text" id="product-category" class="form-control" placeholder="Category (e.g., Electronics)">
                    </div>
                    <div class="col-md-6">
                        <div class="input-group">
                            <input type="text" id="product-price" class="form-control" placeholder="Price (e.g., 100)">
                            <button class="btn btn-outline-danger" type="button" id="product-btn">Search</button>
                        </div>
                    </div>
                </div>
                <h6>SQL Query:</h6>
                <pre id="product-query">SELECT * FROM products WHERE category = :category AND price < :price</pre>
                <h6>Result:</h6>
                <pre id="product-result" style="max-height: 200px; overflow-y: auto;">Results will appear here</pre>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0">Vulnerable Product Keyword Search</h5>
            </div>
            <div class="card-body">
                <h6>Search Products by Keyword (Vulnerable to SQL Injection)</h6>
                <p>Try the attack: <span class="attack-example">Laptop' OR '1'='1</span></p>
                <div class="input-group mb-3">
                    <input type="text" id="keyword-input" class="form-control" placeholder="Enter keyword">
                    <button class="btn btn-outline-danger" type="button" id="keyword-btn">Search</button>
                </div>
                <h6>SQL Query:</h6>
                <pre id="keyword-query">SELECT * FROM products WHERE name LIKE '%input%'</pre>
                <h6>Result:</h6>
                <pre id="keyword-result" style="max-height: 200px; overflow-y: auto;">Results will appear here</pre>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // User search
            document.getElementById('user-btn').addEventListener('click', function() {
                const username = document.getElementById('user-input').value;
                document.getElementById('user-query').textContent = `SELECT * FROM users WHERE username = '${username}'`;
                
                fetch(`/api/security-demo/vulnerable/user?username=${encodeURIComponent(username)}`)
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('user-result').textContent = JSON.stringify(data, null, 2);
                    })
                    .catch(error => {
                        document.getElementById('user-result').textContent = 'Error: ' + error;
                    });
            });
            
            // Role search
            document.getElementById('role-btn').addEventListener('click', function() {
                const role = document.getElementById('role-input').value;
                document.getElementById('role-query').textContent = `SELECT * FROM users WHERE role = '${role}'`;
                
                fetch(`/api/security-demo/vulnerable/role?role=${encodeURIComponent(role)}`)
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('role-result').textContent = JSON.stringify(data, null, 2);
                    })
                    .catch(error => {
                        document.getElementById('role-result').textContent = 'Error: ' + error;
                    });
            });
            
            // Product search
            document.getElementById('product-btn').addEventListener('click', function() {
                const category = document.getElementById('product-category').value;
                const price = document.getElementById('product-price').value;
                document.getElementById('product-query').textContent = `SELECT * FROM products WHERE category = '${category}' AND price < '${price}'`;
                
                fetch(`/api/security-demo/vulnerable/products?category=${encodeURIComponent(category)}&price=${encodeURIComponent(price)}`)
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('product-result').textContent = JSON.stringify(data, null, 2);
                    })
                    .catch(error => {
                        document.getElementById('product-result').textContent = 'Error: ' + error;
                    });
            });
            
            // Keyword search
            document.getElementById('keyword-btn').addEventListener('click', function() {
                const keyword = document.getElementById('keyword-input').value;
                document.getElementById('keyword-query').textContent = `SELECT * FROM products WHERE name LIKE '%${keyword}%'`;
                
                fetch(`/api/security-demo/vulnerable/products/search?keyword=${encodeURIComponent(keyword)}`)
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('keyword-result').textContent = JSON.stringify(data, null, 2);
                    })
                    .catch(error => {
                        document.getElementById('keyword-result').textContent = 'Error: ' + error;
                    });
            });
        });
    </script>
</body>
</html>
